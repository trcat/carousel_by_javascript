"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,i,e){return i&&_defineProperties(t.prototype,i),e&&_defineProperties(t,e),t}var Carousel=function(){function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,i),this.el=t.el,this.space=t.space||20,this.direction=t.direction||"left",this.duration=t.duration||1e4,this.dirBtn=t.dirBtn||{},this.container=null,this.items=null,this.wrap=null,this.translateLimit=0,this.speed=0,this.realDistance=0,this.timer=null,this.shouldCarousel=!0,this.init()}return _createClass(i,[{key:"init",value:function(){this.initContainer(),this.initItems(),this.initCloneNode(),this.initWrap(),this.initConfig(),this.initCarousel(),this.initDirBtn()}},{key:"initContainer",value:function(){var t=document.querySelector(this.el);if(!t)throw new Error("找不到 container");t.style.margin="0",t.style.padding="0",t.style.overflow="hidden",this.container=t}},{key:"initItems",value:function(){var e=this,n=0;this.items=document.querySelectorAll("".concat(this.el," .carousel-item")),this.items.forEach(function(t,i){n+=e.getElementWidth(t),t.style.float="left",0<i&&(t.style.marginLeft="".concat(e.space,"px"),n+=e.space)}),this.shouldCarousel=n>this.getElementWidth(this.container),this.shouldCarousel&&(this.translateLimit=n+this.space)}},{key:"initCloneNode",value:function(){if(this.shouldCarousel){for(var t=this.getElementWidth(this.container),i=-1,e=i;e<t&&i<this.items.length-1;)i+=1,e+=this.getElementWidth(this.items[i]);for(var n=-1;n<i;){n+=1;var s=this.items[n].cloneNode(!0);0===n&&(s.style.marginLeft="".concat(this.space,"px")),this.container.append(s)}}}},{key:"initWrap",value:function(){var t=this,i=document.createElement("div");for(i.style.width="".concat(this.computeWidth(this.container,this.space),"px"),i.style.position="relative",i.style.overflow="auto",i.style.margin="0",i.style.padding="0";this.container.firstChild;)i.append(this.container.firstChild);this.container.append(i),this.wrap=i,this.shouldCarousel&&(this.wrap.onmouseover=function(){window.clearInterval(t.timer)},this.wrap.onmouseleave=function(){t.initCarousel()})}},{key:"initConfig",value:function(){this.shouldCarousel&&(this.speed=this.translateLimit/this.duration,"left"===this.direction?this.realDistance=0:(this.realDistance=-1*this.translateLimit,this.wrap.style.transform="translateX(".concat(this.realDistance,"px)")))}},{key:"initCarousel",value:function(){this.shouldCarousel&&(this.timer&&window.clearTimeout(this.timer),this.timer=window.setTimeout(this.startCarousel()))}},{key:"initDirBtn",value:function(){var t=this;this.shouldCarousel&&(this.dirBtn.left&&document.querySelector(this.dirBtn.left)&&(document.querySelector(this.dirBtn.left).onclick=function(){"left"!==t.direction&&(t.direction="left",t.initCarousel())}),this.dirBtn.right&&document.querySelector(this.dirBtn.right)&&(document.querySelector(this.dirBtn.right).onclick=function(){"right"!==t.direction&&(t.direction="right",t.initCarousel())}))}},{key:"startCarousel",value:function(){var t=this;this.timer&&window.clearTimeout(this.timer),"left"===this.direction?Math.abs(this.realDistance)>=this.translateLimit?this.realDistance=0:this.realDistance-=this.speed:0<=this.realDistance?this.realDistance=-1*this.translateLimit:this.realDistance+=this.speed,this.wrap.style.transform="translateX(".concat(this.realDistance,"px)"),this.timer=window.setTimeout(function(){return t.startCarousel()},1)}},{key:"computeWidth",value:function(t,i){for(var e=0,n=0;n<t.children.length;n++)e+=this.getElementWidth(t.children[n]),0!==n&&(e+=i);return e}},{key:"getElementWidth",value:function(t){return Number(window.getComputedStyle(t).width.split("px")[0])}}]),i}();try{exports.default=Carousel}catch(t){}